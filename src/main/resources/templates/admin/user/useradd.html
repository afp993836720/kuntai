<html lang="en" xmlns:th="http://www.thymeleaf.org">

<div th:insert="~{admin/head :: headFragment}"></div>
<div th:insert="~{admin/head :: sectionFragment}"></div>


<!-- 编辑器引入开始 -->
<link th:href="@{/umeditor/themes/default/css/umeditor.css}" type="text/css" rel="stylesheet">
<script type="text/javascript" src="/umeditor/third-party/jquery.min.js"></script>
<script type="text/javascript" src="/umeditor/third-party/template.min.js"></script>
<script type="text/javascript" charset="utf-8" src="/umeditor/umeditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="/umeditor/umeditor.min.js"></script>
<script type="text/javascript" src="/umeditor/lang/zh-cn/zh-cn.js"></script>

<!-- 编辑器引入结束 -->
<div th:insert="~{admin/menu :: menuFragment}"></div>


<!--main content start-->
      <section id="main-content">
          <section class="wrapper">
              
            
          <div class="row">
                  <div class="col-sm-12">
                      <aside class="profile-info col-lg-9">
                      <section class="panel">
                          
                          <div class="panel-body bio-graph-info">
                              <h1 th:text="${isedit == 1}?'编辑用户':'添加用户'"> 添加用户</h1>
                              <form class="form-horizontal" role="form" method="post" id="formid">

                                  <div class="form-group">
                                      <label class="col-lg-2 control-label">用户名</label>
                                      <div class="col-lg-6">
                                          <input type="text" class="form-control"  th:value="${user.username != null}?${user.username}:'系统生成'" disabled="true" >
                                      </div>
                                  </div>

                                  <div class="form-group">
                                      <label class="col-lg-2 control-label">手机号</label>
                                      <div class="col-lg-6">
                                          <input type="text" class="form-control"  th:value="${user.utel != null}?${user.utel}:''" name="utel" style="" onkeyup='this.value=this.value.replace(/\W/,"")'>
                                      </div>
                                  </div>

                                  <div class="form-group">
                                      <label class="col-lg-2 control-label">真实姓名</label>
                                      <div class="col-lg-6">
                                          <input type="text" class="form-control"  th:value="${user.nickname != null}?${user.nickname}:''" name="nickname" style="" onkeyup='this.value=this.value.replace(/\W/,"")'>
                                      </div>
                                  </div>
								<!--{if isset($isedit) && $isedit == 1}-->
                                  <div class="form-group" th:if="${isedit == 1}">
                                      <label class="col-lg-2 control-label">状态</label>
                                      <div class="col-lg-6">
                                          <select name="ustatus" class="selectpicker show-tick form-control">
                                          	  <option th:selected="${user.ustatus != null && user.ustatus == 0}" value="0">正常</option>
                                          	  <option th:selected="${user.ustatus != null && user.ustatus == 1}" value="1">冻结</option>
                                          </select>
                                      </div>
                                  </div>
								 <!--{/if}-->
                                  <div class="form-group">
                                      <label class="col-lg-2 control-label">邀请码</label>
                                      <div class="col-lg-6">
                                          <p>默认为自己的下线客户</p>
                                      </div>
                                  </div>
									<!--{if isset($isedit) && $isedit == 1}-->


                                  

                                  <div class="form-group" th:if="${isedit == 1}">
                                      <label class="col-lg-2 control-label">账户余额</label>
                                      <div class="col-lg-6">
                                          <input type="text" class="form-control"  th:value="${user.usermoney != null}?${user.usermoney}:'0'" name="usermoney">
                                          <input type="hidden" class="form-control"  th:value="${user.usermoney != null}?${user.usermoney}:'0'" name="ordusermoney">
                                      </div>
                                  </div>
									
								<div class="form-group" th:if="${isedit == 1}">
                                      <label class="col-lg-2 control-label">旧密码</label>
                                      <div class="col-lg-6">
                                          <input type="text" class="form-control"  value="" name="ordpwd">
                                      </div>
                                  </div>

                                  <div class="form-group" th:if="${isedit == 1}">
                                      <label class="col-lg-2 control-label">新密码</label>
                                      <div class="col-lg-6">
                                          <input type="text" class="form-control"  value="" name="upwd">
                                      </div>
                                  </div>

                                  <div class="form-group" th:if="${isedit == 1}">
                                      <label class="col-lg-2 control-label">确认密码</label>
                                      <div class="col-lg-6">
                                          <input type="text" class="form-control"  value="" name="upwd2">
                                      </div>
                                  </div>
                                  <input type="hidden" class="form-control"  th:value="${user.uid}" name="uid" th:if="${user != null}">
								<div class="form-group" th:unless="${isedit == 1}">
                                      <label class="col-lg-2 control-label">密码</label>
                                      <div class="col-lg-6">
                                          <input type="text" class="form-control"  value="" name="upwd">
                                      </div>
                                  </div>

                                  <div class="form-group" th:unless="${isedit == 1}">
                                      <label class="col-lg-2 control-label">确认密码</label>
                                      <div class="col-lg-6">
                                          <input type="text" class="form-control"  value="" name="upwd2">
                                      </div>
                                  </div>
                                  <input type="hidden" class="form-control"  value="" name="ordpwd">
                                  <input type="hidden" class="form-control"  th:value="${isedit}" name="type">
								<!--{/if}-->
									

                                  

                                  <div class="form-group">
                                      <div class="col-lg-offset-2 col-lg-10">
                                          <input type="submit" value="提交"  onclick="return editcon(this.form)" class="btn btn-success">
                                          
                                      </div>
                                  </div>

                              </form>
                          </div>
                      </section>
                      
                  </aside>
                  </div>

          </div>       
          
          
             

          </section>
      </section>
      <!--main content end-->
  </section>

<div th:insert="~{admin/foot :: footerFragment}"></div>
<script type="text/javascript" src="/umeditor/umindex.js"></script>
<script>

	function editcon(form){
		var type = form.type.value;
		var utel = form.utel.value;
		var nickname = form.nickname.value;
		var upwd = form.upwd.value;
		var upwd2 = form.upwd2.value;
		var ordpwd = form.ordpwd.value;

		if(type == 0 || (type == 1 && ordpwd)){ 
			if(!upwd){layer.msg('请输入密码'); return false;}
			if(upwd.length < 6){layer.msg('密码长度大于6位'); return false;}
			if(!upwd2){layer.msg('请再输入密码'); return false;}
			if(upwd !== upwd2){layer.msg('两次输入密码不同'); return false;}
		}

		if(type == 0){
			var formurl = "useredit";
			if(!utel){layer.msg('请输入手机号'); return false;}
		}else{
			var formurl = "useredit";
		}

		
		if(!nickname){layer.msg('请输入真实姓名'); return false;}
		
	    var data = $('#formid').serialize();
	    var locurl = "userlist";

	    WPpost(formurl,data,locurl);

	    return false;
	}


</script>